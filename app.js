const loginBtn=document.getElementById("loginBtn");const loginSection=document.getElementById("loginSection");const switchMode=document.getElementById("switchMode");const authForm=document.getElementById("authForm");const authTitle=document.getElementById("authTitle");const authMsg=document.getElementById("authMsg");const authSubmit=document.getElementById("authSubmit");const dashboard=document.getElementById("dashboard");const addProductBtn=document.getElementById("addProductBtn");const productForm=document.getElementById("productForm");const frmProduct=document.getElementById("frmProduct");const cancelProduct=document.getElementById("cancelProduct");const productsList=document.getElementById("productsList");const publicProducts=document.getElementById("publicProducts");const whatsappBtn=document.getElementById("whatsappBtn");const year=document.getElementById("year");let isLoginMode=true;let currentUser=null;year.textContent=new Date().getFullYear();whatsappBtn.addEventListener("click",()=>{const phone=prompt("اپنا WhatsApp نمبر درج کریں (مثلاً 923001234567):");if(phone){window.open(`https://wa.me/${phone}`,"_blank");}});loginBtn.addEventListener("click",()=>{loginSection.classList.remove("hidden");});switchMode.addEventListener("click",()=>{isLoginMode=!isLoginMode;authTitle.textContent=isLoginMode?"لاگ ان":"رجسٹر";authSubmit.textContent=isLoginMode?"لاگ ان":"رجسٹر";switchMode.textContent=isLoginMode?"رجسٹر کریں":"واپس لاگ ان پر جائیں";authMsg.textContent="";});authForm.addEventListener("submit",e=>{e.preventDefault();const email=document.getElementById("authEmail").value;const pass=document.getElementById("authPass").value;const users=JSON.parse(localStorage.getItem("users")||"[]");const foundUser=users.find(u=>u.email===email);if(isLoginMode){if(foundUser&&foundUser.pass===pass){currentUser=foundUser;loginSection.classList.add("hidden");dashboard.classList.remove("hidden");loginBtn.textContent="لاگ آؤٹ";loadProducts();}else{authMsg.textContent="ای میل یا پاس ورڈ غلط ہے!";}}else{if(foundUser){authMsg.textContent="یہ یوزر پہلے سے موجود ہے!";}else{const newUser={email,pass};users.push(newUser);localStorage.setItem("users",JSON.stringify(users));alert("اکاؤنٹ بن گیا! اب لاگ ان کریں۔");isLoginMode=true;switchMode.click();}}});loginBtn.addEventListener("click",()=>{if(currentUser){currentUser=null;dashboard.classList.add("hidden");loginBtn.textContent="لاگ ان";}});addProductBtn.addEventListener("click",()=>{productForm.classList.remove("hidden");});cancelProduct.addEventListener("click",()=>{productForm.classList.add("hidden");});frmProduct.addEventListener("submit",e=>{e.preventDefault();const title=document.getElementById("pTitle").value;const price=document.getElementById("pPrice").value;const desc=document.getElementById("pDesc").value;const image=document.getElementById("pImage").value||"https://via.placeholder.com/300x200";const products=JSON.parse(localStorage.getItem("products")||"[]");const newProduct={id:Date.now(),title,price,desc,image,owner:currentUser?.email||"guest"};products.push(newProduct);localStorage.setItem("products",JSON.stringify(products));frmProduct.reset();productForm.classList.add("hidden");loadProducts();});function loadProducts(){const products=JSON.parse(localStorage.getItem("products")||"[]");productsList.innerHTML="";publicProducts.innerHTML="";products.forEach(p=>{const card=document.createElement("div");card.classList.add("product-card");card.innerHTML=`<img src="${p.image}" alt="${p.title}"><h3>${p.title}</h3><div class="price">💲${p.price}</div><div class="desc">${p.desc}</div><div class="actions"><button class="btn danger" onclick="deleteProduct(${p.id})">حذف</button></div>`;productsList.appendChild(card);const pubCard=card.cloneNode(true);pubCard.querySelector(".actions").remove();publicProducts.appendChild(pubCard);});}function deleteProduct(id){const products=JSON.parse(localStorage.getItem("products")||"[]");const updated=products.filter(p=>p.id!==id);localStorage.setItem("products",JSON.stringify(updated));loadProducts();}loadProducts();